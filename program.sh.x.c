#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f program.sh 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\152"
#define      chk1_z	22
#define      chk1	((&data[4]))
	"\031\257\253\237\276\053\371\107\124\110\252\061\320\327\240\266"
	"\251\120\352\204\210\347\220\265\110\037\321\231\053\206"
#define      tst1_z	22
#define      tst1	((&data[34]))
	"\272\263\001\365\032\160\300\066\102\154\052\266\000\107\301\172"
	"\037\172\310\344\162\174\325\063\133\045\217\334\024"
#define      msg2_z	19
#define      msg2	((&data[63]))
	"\327\375\354\227\253\111\001\172\033\234\007\110\113\024\300\057"
	"\145\267\336\157\254\333\125\151\163"
#define      date_z	1
#define      date	((&data[85]))
	"\325"
#define      pswd_z	256
#define      pswd	((&data[90]))
	"\271\061\222\123\067\020\215\043\360\215\311\013\370\174\113\272"
	"\100\327\343\115\017\242\101\342\330\233\373\070\347\274\211\171"
	"\055\014\276\144\035\114\207\016\332\121\032\323\316\146\215\016"
	"\075\160\134\114\022\235\057\353\070\053\044\040\350\256\232\025"
	"\272\131\171\330\245\001\347\177\122\001\123\040\150\340\056\246"
	"\121\213\362\144\050\042\117\141\116\164\201\066\042\034\113\335"
	"\165\305\266\033\307\235\232\031\237\356\072\007\316\151\255\037"
	"\364\240\203\035\303\323\176\021\107\377\110\151\033\224\107\221"
	"\132\375\254\041\233\107\073\073\065\165\103\003\337\361\042\324"
	"\222\246\361\125\171\157\147\301\156\257\053\212\104\162\033\236"
	"\160\310\277\013\017\372\107\104\160\212\110\117\173\153\043\015"
	"\021\024\143\213\203\312\114\362\172\167\175\276\351\231\134\132"
	"\141\034\145\160\027\254\265\207\067\375\327\262\151\373\300\172"
	"\017\043\006\223\355\122\206\150\311\003\047\263\234\204\015\375"
	"\240\163\156\267\040\044\077\127\042\026\012\213\021\312\006\041"
	"\356\014\265\333\136\073\104\050\076\153\334\333\357\352\331\217"
	"\135\107\107\176\135\031\311\347\333\203\232\335\250\052\271\275"
	"\243\157\141\172\155\116\320\326\301\374\317\323\012\340\224\303"
	"\022\047\026\157\101\337\127\035\143\362\372\013\034\263\310\300"
	"\042\052\072\217\170"
#define      msg1_z	65
#define      msg1	((&data[401]))
	"\010\065\015\022\026\241\026\003\344\216\345\336\147\304\146\037"
	"\324\076\147\277\363\325\207\221\043\271\275\046\066\013\106\013"
	"\123\250\007\125\172\213\163\367\354\211\345\270\122\062\003\017"
	"\255\376\244\072\127\027\234\046\355\171\241\176\357\261\307\310"
	"\026\223\133\352\067\107\271\326\050\311"
#define      tst2_z	19
#define      tst2	((&data[471]))
	"\315\360\027\070\051\367\004\205\002\172\160\105\114\266\034\111"
	"\263\371\004\056\131"
#define      shll_z	8
#define      shll	((&data[490]))
	"\334\004\076\232\347\011\273\110\041\074"
#define      chk2_z	19
#define      chk2	((&data[504]))
	"\277\370\057\372\110\265\161\227\360\231\117\335\116\161\027\354"
	"\235\251\224\170\114\142\227"
#define      rlax_z	1
#define      rlax	((&data[523]))
	"\232"
#define      inlo_z	3
#define      inlo	((&data[524]))
	"\271\240\276"
#define      xecc_z	15
#define      xecc	((&data[530]))
	"\073\221\367\167\014\323\275\002\153\220\321\042\017\344\011\124"
	"\110\124"
#define      opts_z	1
#define      opts	((&data[545]))
	"\150"
#define      text_z	3377
#define      text	((&data[881]))
	"\355\215\343\317\256\040\316\203\045\215\174\124\207\004\375\215"
	"\363\337\233\027\317\275\123\141\265\270\274\232\265\041\116\242"
	"\256\062\162\135\122\100\341\167\316\135\314\126\141\311\344\124"
	"\251\200\154\170\075\277\331\362\167\226\215\055\267\333\317\146"
	"\016\102\304\140\202\245\330\121\002\244\250\143\156\214\270\027"
	"\014\044\220\112\344\152\075\134\000\312\211\270\246\131\037\265"
	"\233\343\025\036\210\355\160\213\222\030\356\000\245\247\030\261"
	"\313\250\374\260\022\071\014\023\004\225\313\253\357\353\140\213"
	"\316\165\251\126\143\032\341\366\062\320\366\327\170\017\211\103"
	"\267\205\363\312\277\000\336\303\226\252\157\205\225\317\020\143"
	"\105\272\272\251\324\234\237\007\155\226\337\345\245\150\051\134"
	"\356\034\047\255\034\005\161\263\260\340\070\105\260\111\250\366"
	"\004\142\237\331\377\076\340\154\324\300\121\171\051\172\326\027"
	"\227\376\305\264\004\067\147\264\030\240\371\310\351\242\276\356"
	"\005\135\307\004\234\250\160\160\150\302\352\221\074\301\251\324"
	"\277\156\210\304\246\357\170\276\217\162\206\171\024\105\147\032"
	"\242\057\036\077\330\217\257\100\121\232\322\216\133\174\142\033"
	"\353\353\337\221\332\130\117\152\312\326\344\337\033\114\371\276"
	"\173\030\375\123\250\255\224\371\107\147\210\243\343\353\276\316"
	"\326\236\137\261\366\257\034\301\205\000\241\240\114\233\136\310"
	"\263\133\034\133\011\261\125\121\030\335\364\374\310\263\313\121"
	"\115\133\144\162\133\273\157\365\160\131\057\175\112\073\025\231"
	"\035\004\343\245\255\002\005\122\227\351\001\262\027\062\346\312"
	"\362\270\205\354\230\256\202\021\271\024\117\311\116\227\213\065"
	"\230\207\235\117\142\336\363\154\241\153\020\130\063\341\364\176"
	"\002\251\175\314\133\055\326\206\247\151\204\212\333\275\131\331"
	"\356\325\006\222\201\156\333\032\221\037\345\371\011\330\054\261"
	"\207\123\301\174\104\176\064\106\111\303\361\015\004\037\317\052"
	"\245\344\166\251\264\302\112\270\270\027\324\352\110\247\056\067"
	"\130\330\344\001\147\334\110\201\072\047\076\164\023\310\117\067"
	"\006\261\136\145\317\117\366\343\052\011\256\251\310\011\260\064"
	"\326\104\117\221\153\234\070\265\364\070\204\037\346\240\314\042"
	"\166\217\102\301\212\204\055\223\020\160\121\372\233\144\023\035"
	"\322\374\233\255\160\346\234\132\054\360\236\067\377\326\214\340"
	"\341\147\375\223\311\050\035\273\264\227\256\210\214\051\064\174"
	"\043\123\122\376\157\136\034\025\335\304\314\350\342\145\212\320"
	"\234\017\172\300\322\101\250\161\261\314\362\071\340\163\366\034"
	"\065\365\020\017\152\374\271\256\056\252\037\040\345\025\333\056"
	"\377\256\213\111\065\264\333\223\356\267\132\325\222\105\317\304"
	"\030\311\165\054\031\227\047\362\170\336\025\371\206\253\233\057"
	"\306\035\354\147\320\201\343\072\270\133\246\304\230\116\276\155"
	"\065\322\226\023\213\000\206\264\240\123\051\202\370\100\111\336"
	"\106\027\141\260\377\124\307\243\336\207\271\236\365\106\074\262"
	"\230\360\052\341\306\172\003\247\351\266\235\232\103\203\232\003"
	"\155\163\335\015\271\160\177\231\045\211\023\230\043\200\211\152"
	"\005\214\077\131\275\132\343\054\347\354\147\264\132\213\105\320"
	"\333\075\144\045\125\032\253\207\270\364\326\176\111\247\364\012"
	"\206\135\070\255\075\027\221\122\044\304\320\144\034\234\217\171"
	"\212\351\152\225\070\025\157\170\233\123\217\102\064\112\074\313"
	"\222\031\232\277\341\361\150\277\334\221\031\204\331\124\165\066"
	"\333\366\000\345\321\300\060\176\267\212\362\223\162\320\207\134"
	"\154\366\003\237\310\357\023\257\301\032\223\241\127\124\077\112"
	"\266\375\126\036\363\026\025\221\126\000\032\051\216\260\103\211"
	"\302\245\315\100\320\343\367\277\075\156\031\165\007\063\157\170"
	"\134\175\133\250\167\275\316\215\124\221\204\057\302\266\336\050"
	"\340\115\210\366\022\175\201\263\041\135\157\263\104\073\340\353"
	"\135\302\347\361\175\074\056\222\375\345\115\370\046\354\040\305"
	"\313\333\021\107\335\206\247\155\150\274\072\301\316\076\136\302"
	"\071\000\015\026\165\362\265\230\070\246\344\363\160\302\364\163"
	"\340\275\323\242\230\043\333\124\065\307\377\175\243\323\255\316"
	"\261\310\342\044\063\360\202\321\225\355\052\010\117\117\024\170"
	"\275\361\137\220\131\027\205\173\273\152\243\150\306\001\110\213"
	"\146\310\315\370\207\126\064\001\351\363\157\006\141\052\043\346"
	"\011\122\157\231\360\301\246\326\071\166\064\232\101\036\145\330"
	"\340\165\031\072\257\110\334\111\121\120\050\175\116\246\146\166"
	"\017\230\344\036\033\272\321\022\116\246\173\035\247\201\266\203"
	"\331\261\233\206\200\153\367\027\375\032\254\035\127\063\223\017"
	"\337\324\306\270\260\245\135\013\036\100\102\257\327\275\310\237"
	"\043\171\120\142\303\267\056\176\042\117\004\312\062\053\073\126"
	"\212\015\301\026\132\015\034\207\046\376\050\167\231\337\366\335"
	"\262\356\031\141\334\211\210\221\301\312\042\132\264\137\321\134"
	"\300\206\221\050\107\064\140\126\136\227\116\350\312\127\343\377"
	"\340\264\156\311\056\366\137\272\171\153\170\143\046\077\206\250"
	"\364\343\247\070\321\040\375\316\154\026\374\053\337\000\330\247"
	"\242\347\231\101\023\377\125\107\050\031\166\366\067\223\223\107"
	"\263\223\157\324\150\124\176\166\261\046\017\104\171\171\030\125"
	"\021\035\315\361\014\010\034\224\127\111\340\117\233\121\321\273"
	"\306\166\033\060\004\352\156\033\101\111\345\155\046\362\027\131"
	"\265\075\224\011\157\136\374\133\241\154\175\022\240\307\260\235"
	"\153\053\041\153\100\177\313\136\123\135\251\063\016\263\022\237"
	"\137\263\014\263\307\241\266\032\312\073\004\244\200\066\055\175"
	"\127\331\213\147\157\146\137\142\340\043\052\110\226\026\200\255"
	"\244\307\256\360\236\020\160\136\331\303\257\000\306\212\166\003"
	"\320\320\270\363\155\355\167\166\316\116\264\346\321\251\243\314"
	"\357\144\261\364\047\014\260\255\155\075\074\176\300\171\166\043"
	"\366\211\121\152\266\155\254\023\106\333\234\351\335\342\256\366"
	"\365\143\370\377\125\065\263\053\060\163\060\215\361\000\072\134"
	"\343\054\126\134\037\047\226\075\242\300\305\244\335\122\146\042"
	"\314\165\133\330\310\256\246\207\045\065\335\162\030\103\367\045"
	"\145\370\101\267\357\334\130\262\301\360\054\055\017\117\034\371"
	"\116\314\146\150\247\303\070\103\304\110\006\361\170\242\077\053"
	"\255\204\100\053\174\076\050\166\113\122\030\054\260\270\306\205"
	"\015\261\071\357\030\217\371\161\050\064\172\133\126\054\207\037"
	"\073\245\072\050\311\170\154\077\244\160\233\375\010\024\141\222"
	"\134\252\145\103\035\026\250\203\052\223\366\152\373\220\214\215"
	"\104\313\262\146\374\133\335\042\226\166\117\336\365\310\354\056"
	"\247\104\076\344\345\225\335\065\241\122\125\357\150\216\073\077"
	"\100\332\224\310\155\152\366\111\111\340\327\204\302\361\212\277"
	"\106\136\362\013\377\363\312\055\074\350\153\106\216\062\053\303"
	"\141\017\052\366\302\201\265\360\216\221\005\074\254\017\103\354"
	"\330\122\010\200\174\150\365\317\042\243\222\372\111\163\165\376"
	"\135\062\070\244\224\145\127\235\046\110\073\132\352\101\377\022"
	"\261\151\203\233\073\011\331\351\015\076\051\363\304\236\025\232"
	"\176\034\043\365\255\374\372\362\266\026\125\300\341\054\133\370"
	"\357\332\305\172\303\051\212\164\323\262\353\046\114\313\227\365"
	"\133\306\106\017\073\303\362\075\265\126\303\030\024\341\205\206"
	"\244\154\057\176\167\302\356\316\016\240\103\073\365\272\112\154"
	"\036\203\004\114\005\344\032\271\220\113\051\153\276\102\334\267"
	"\211\016\040\366\036\272\154\144\142\326\333\106\020\311\065\103"
	"\075\170\316\137\235\174\300\133\346\162\364\221\225\055\364\342"
	"\164\300\311\237\210\010\307\222\063\304\310\307\322\061\332\357"
	"\030\336\164\005\260\215\030\125\147\146\206\210\174\310\335\026"
	"\020\224\035\221\377\077\223\241\366\333\334\121\137\277\020\276"
	"\204\217\130\347\257\324\310\346\315\017\042\070\366\031\153\331"
	"\145\357\170\272\217\203\305\362\064\267\151\216\371\163\335\136"
	"\210\145\214\305\320\050\346\026\137\100\163\010\250\356\023\020"
	"\232\323\045\101\250\017\004\325\005\003\376\325\005\115\047\064"
	"\024\311\023\220\370\073\240\235\053\376\011\141\212\064\167\125"
	"\304\376\371\021\363\331\347\300\243\115\345\020\313\320\076\201"
	"\233\320\061\355\220\275\360\324\173\337\215\061\234\155\360\251"
	"\174\105\002\270\123\140\300\040\267\333\235\174\342\146\263\103"
	"\327\154\231\123\062\063\364\256\166\245\272\027\366\053\306\212"
	"\104\330\162\221\276\335\321\372\157\352\300\265\347\337\277\334"
	"\247\333\044\312\052\111\016\322\242\101\043\051\005\220\073\072"
	"\336\241\021\330\123\276\321\304\353\361\001\356\023\372\361\171"
	"\004\342\213\242\021\203\231\274\346\200\054\234\213\070\344\114"
	"\046\051\355\303\050\363\054\337\060\140\325\142\072\366\300\245"
	"\151\170\152\371\174\147\134\005\147\347\232\327\273\017\326\010"
	"\222\346\010\317\223\112\265\136\337\034\270\305\046\254\313\331"
	"\113\272\267\151\226\003\062\375\074\123\261\272\333\156\232\253"
	"\272\005\104\110\040\163\022\363\221\165\363\106\015\312\200\372"
	"\252\243\313\344\143\075\260\254\117\347\360\345\170\203\102\266"
	"\211\311\312\120\061\065\131\022\022\264\345\300\050\320\104\322"
	"\252\277\373\152\347\226\037\013\116\367\054\274\367\244\247\133"
	"\162\065\321\005\117\246\371\221\257\043\210\332\351\102\053\242"
	"\105\302\312\243\254\346\002\171\106\233\366\072\234\337\312\135"
	"\156\224\203\267\246\026\063\313\203\155\232\041\046\267\267\033"
	"\221\103\146\304\351\233\060\222\157\027\173\365\232\023\311\060"
	"\147\147\307\103\267\270\162\145\001\244\310\204\056\304\157\242"
	"\243\143\306\105\321\374\167\071\024\221\103\045\244\373\133\215"
	"\047\156\172\006\021\027\034\154\375\135\310\145\347\314\176\143"
	"\151\113\011\013\020\126\112\230\224\334\127\354\121\024\134\337"
	"\230\053\023\030\170\207\162\330\321\326\142\000\042\216\074\251"
	"\324\164\377\232\012\172\204\251\006\270\074\157\136\011\175\103"
	"\207\310\062\173\270\101\300\201\044\001\102\277\073\035\205\267"
	"\364\211\363\347\370\017\033\012\214\331\073\264\370\131\305\210"
	"\060\230\001\003\336\166\340\104\301\310\035\004\017\004\142\146"
	"\314\310\171\112\257\210\377\027\201\270\153\106\074\225\212\200"
	"\162\043\327\333\312\045\072\005\162\123\005\351\032\271\323\110"
	"\034\365\310\343\067\304\103\212\332\160\072\257\156\140\000\334"
	"\305\113\117\207\325\052\346\262\325\300\047\156\312\330\102\105"
	"\346\034\061\031\251\271\067\067\173\100\357\063\077\230\006\011"
	"\033\053\220\154\102\242\026\053\104\253\022\263\105\331\360\321"
	"\034\310\011\244\255\213\060\111\307\164\101\224\234\037\037\274"
	"\201\320\206\225\145\364\111\315\053\350\124\045\123\257\131\152"
	"\362\353\155\061\376\173\050\101\246\063\146\302\036\351\313\361"
	"\375\061\267\001\304\064\004\046\104\103\303\262\156\302\065\253"
	"\070\217\273\050\215\013\232\336\031\014\340\274\034\271\215\233"
	"\360\147\275\013\331\106\351\224\345\247\322\200\307\132\340\270"
	"\347\342\300\135\366\205\275\073\144\023\157\212\245\111\304\351"
	"\035\216\074\101\366\070\046\245\055\341\207\213\305\235\327\322"
	"\252\017\032\335\115\317\347\146\204\237\006\335\152\347\076\057"
	"\124\104\346\334\213\351\327\373\055\224\004\141\144\252\207\354"
	"\325\372\370\170\356\256\276\362\105\176\162\147\374\116\276\331"
	"\123\176\233\106\066\216\240\006\003\262\132\166\044\224\126\044"
	"\002\324\306\156\365\254\345\245\007\136\266\224\352\011\270\357"
	"\104\251\250\325\051\247\266\241\043\071\335\370\100\145\130\314"
	"\315\133\133\245\241\255\141\035\100\064\303\122\066\314\320\215"
	"\057\370\070\173\105\147\212\300\317\176\344\317\227\342\353\203"
	"\333\123\047\267\070\011\155\371\273\105\222\300\327\230\104\254"
	"\064\351\247\050\073\316\265\354\076\153\306\117\117\074\347\260"
	"\051\277\050\007\005\025\267\027\055\237\171\156\057\050\006\326"
	"\075\213\145\066\341\366\253\142\201\006\227\112\064\163\263\055"
	"\225\007\225\152\213\236\037\346\222\131\216\245\177\076\036\372"
	"\070\136\265\054\336\105\152\241\117\304\022\005\146\140\223\141"
	"\231\307\175\303\070\344\026\176\366\350\131\366\067\244\371\214"
	"\014\147\123\203\122\073\256\363\066\335\103\160\266\037\345\056"
	"\121\101\202\356\122\051\342\365\275\300\103\330\253\254\255\361"
	"\247\256\352\031\344\013\076\134\367\041\170\074\161\375\123\263"
	"\127\045\237\230\263\326\164\165\020\246\073\101\064\147\234\160"
	"\364\262\333\070\236\170\253\077\143\004\145\370\324\233\146\136"
	"\375\117\067\150\122\060\124\077\351\275\362\377\350\232\066\132"
	"\231\150\216\000\311\225\256\176\051\343\147\266\215\034\341\033"
	"\144\253\203\162\320\317\364\036\326\346\007\144\367\341\116\364"
	"\213\370\264\043\220\352\255\344\323\050\045\104\060\157\333\037"
	"\036\224\206\373\353\040\174\075\116\112\175\174\021\242\071\367"
	"\341\165\217\171\340\100\165\012\323\357\374\166\002\027\023\045"
	"\366\101\005\075\132\040\205\206\332\022\210\265\274\351\116\144"
	"\262\134\242\160\121\016\017\125\143\126\065\340\341\220\145\217"
	"\070\230\105\117\004\070\043\355\310\075\106\352\014\264\355\055"
	"\165\052\301\137\320\176\103\266\016\313\002\162\312\042\000\173"
	"\213\104\357\303\076\020\341\341\133\156\237\153\203\327\016\250"
	"\112\102\020\206\044\022\063\063\145\010\313\344\033\355\330\336"
	"\126\153\323\053\124\036\212\046\344\073\337\234\244\233\053\042"
	"\014\204\166\227\270\001\143\113\246\153\054\376\324\031\142\121"
	"\143\067\301\153\147\244\357\177\074\110\020\141\016\200\074\060"
	"\122\040\040\367\075\341\141\303\175\225\052\053\100\024\324\071"
	"\342\016\156\346\247\253\344\234\376\152\244\256\212\341\350\050"
	"\363\266\161\164\066\362\250\343\166\372\372\044\132\133\370\023"
	"\122\100\030\314\016\151\206\350\132\062\170\077\075\304\212\342"
	"\263\361\236\276\333\117\172\132\236\013\300\022\201\037\310\244"
	"\360\237\127\132\220\003\265\274\037\054\173\144\245\250\363\073"
	"\166\260\163\352\253\354\054\010\232\301\257\317\200\261\147\265"
	"\027\102\210\231\234\053\271\350\123\136\377\120\020\336\114\342"
	"\067\056\353\000\272\126\350\363\006\313\157\247\044\266\074\303"
	"\210\064\312\217\042\243\341\334\332\114\256\320\175\146\071\142"
	"\364\030\045\143\336\013\176\250\047\253\165\140\305\342\130\376"
	"\312\353\066\370\150\102\001\142\104\156\271\310\000\374\301\046"
	"\066\221\333\057\050\361\375\041\342\134\325\236\102\025\306\120"
	"\214\067\122\120\313\105\354\375\061\157\373\224\206\352\210\343"
	"\022\277\124\122\072\145\164\027\137\052\273\213\215\167\324\276"
	"\123\034\311\375\041\166\070\261\321\244\045\065\125\035\225\067"
	"\303\207\331\041\041\240\256\354\264\255\111\277\222\221\247\041"
	"\213\141\047\071\372\362\065\034\123\013\045\227\274\256\172\043"
	"\277\127\033\136\143\117\063\162\251\277\236\104\221\172\250\370"
	"\223\070\062\240\113\057\157\374\020\013\171\107\326\005\173\333"
	"\243\142\370\173\275\166\146\215\207\063\272\013\041\017\160\250"
	"\104\027\362\004\214\367\026\072\153\315\064\300\245\216\222\246"
	"\214\110\001\125\374\171\212\332\010\132\342\302\203\105\161\003"
	"\231\221\373\114\014\044\264\264\352\034\264\272\002\023\335\307"
	"\052\327\270\021\000\154\202\333\070\307\225\034\372\075\231\152"
	"\032\050\314\271\027\307\004\060\213\125\346\003\132\111\375\012"
	"\277\152\361\035\334\317\275\300\104\000\141\052\105\177\201\232"
	"\233\310\056\020\306\303\006\116\335\266\033\021\260\230\146\067"
	"\153\100\041\106\354\051\026\270\223\305\115\325\367\266\305\015"
	"\262\264\256\170\070\167\347\066\367\011\101\002\102\003\246\364"
	"\166\214\224\020\117\362\210\355\361\264\367\317\274\346\233\227"
	"\245\171\053\317\113\220\302\165\034\213\170\304\052\064\011\031"
	"\152\103\215\245\204\254\010\263\132\065\262\326\351\241\131\206"
	"\105\041\313\324\357\341\150\032\126\223\307\345\126\106\027\126"
	"\042\166\110\071\253\073\077\354\203\013\140\063\206\236\042\117"
	"\144\012\261\347\271\027\047\215\035\075\227\027\261\237\035\365"
	"\237\121\052\120\110\332\154\011\137\155\252\377\271\105\136\202"
	"\371\272\237\125\303\120\252\024\151\210\011\146\121\274\061\360"
	"\016\134\100\126\066\255\140\225\032\012\225\324\120\364\126\112"
	"\256\366\237\161\107\112\206\261\322\217\027\044\114\110\024\132"
	"\245\125\260\333\002\020\161\034\033\007\361\154\373\110\266\251"
	"\076\126\033\205\240\242\067\162\061\116\226\175\227\253\330\075"
	"\000\210\030\003\230\212\040\264\221\021\040\214\131\326\066\227"
	"\054\122\035\315\364\124\100\046\243\326\244\073\202\174\170\203"
	"\004\221\206\235\033\246\121\255\267\162\071\020\111\160\250\165"
	"\302\306\103\267\033\203\335\276\132\201\372\334\375\162\137\002"
	"\003\346\240\036\214\361\313\104\143\005\125\254\166\376\042\070"
	"\304\146\360\337\351\315\236\103\116\230\040\114\012\177\117\016"
	"\145\357\055\362\341\370\066\105\376\213\362\165\211\025\256\116"
	"\173\236\056\144\153\314\250\272\144\310\007\157\107\126\176\255"
	"\106\253\237\047\244\326\155\242\142\137\027\354\164\306\072\360"
	"\144\151\124\317\065\375\212\232\305\221\012\015\350\210\272\056"
	"\063\132\126\327\061\303\172\224\042\222\200\227\130\273\207\274"
	"\044\334\214\132\331\026\364\237\247\377\254\220\207\147\276\272"
	"\302\024\222\363\330\014\207\373\236\010\222\366\304\032\263\351"
	"\367\077\103\320\125\070\157\375\067\034\215\276\203\114\171\105"
	"\141\013\071\071\030\301\064\266\312\307\255\216\342\140\167\331"
	"\240\273\252\365\363\032\363\052\066\201\351\272\315\143\377\056"
	"\156\071\150\207\372\234\075\304\144\352\123\106\113\312\037\353"
	"\206\311\341\171\344\324\244\032\126\216\325\043\361\325\122\140"
	"\016\272\347\011\127\045\315\273\020\041\001\133\353\040\106\162"
	"\352\050\353\317\375\220\352\123\036\277\167\017\224\311\160\242"
	"\203\127\253\333\174\171\226\214\232\227\350\206\270\057\371\243"
	"\127\344\162\124\164\135\250\223\034\037\243\260\350\023\123\154"
	"\153\377\107\350\171\335\165\024\165\135\233\056\215\224\321\345"
	"\171\104\071\356\241\342\201\276\001\045\157\352\070\303\127\244"
	"\302\236\214\074\174\002\120\362\140\354\040\355\200\362\322\371"
	"\067\014\350\331\356\151\227\360\216\006\332\307\312\061\153\214"
	"\320\370\311\115\373\032\077\133\006\140\110\207\123\033\201\212"
	"\047\151\144\026\322\373\007\141\002\341\051\314\023\225\131\344"
	"\215\042\061\210\074\161\344\103\322\055\312\045\110\113\260\160"
	"\264\024\207\207\020\216\351\022\160\022\337\204\247\070\150\065"
	"\133\232\276\230\014\242\334\336\317\246\004\030\362\265\210"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
